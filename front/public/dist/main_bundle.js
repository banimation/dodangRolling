(()=>{"use strict";const e=document.getElementById("welcome"),t=document.getElementById("logout"),n=document.getElementById("same-class-user-list"),d=document.getElementById("profile-image"),a=document.getElementById("open-my-rolling-paper"),s=document.getElementById("my-sky"),i=document.getElementById("my-rolling-paper-container"),c=document.getElementById("back"),o=document.getElementById("search-input"),r=document.getElementById("search-container"),l=document.getElementById("search-user-list"),m=document.getElementById("user-sky"),p=document.getElementById("post-container"),u=document.getElementById("post-back"),g=document.getElementById("rolling-paper-owner"),h=document.getElementById("write-back"),E=document.getElementById("write-btn-container"),y=document.getElementById("write-container"),f=document.getElementById("paper-title"),v=document.getElementById("paper-description"),L=document.getElementById("writer-name"),B=document.getElementById("rolling-paper-submit");for(let e=0;e<100;e++){const e=i.getBoundingClientRect().height,t=i.getBoundingClientRect().width,n=Math.floor(Math.random()*e),d=Math.floor(Math.random()*t),a=document.createElement("div");a.classList.add("star"),a.style.top=`${n}px`,a.style.left=`${d}px`,s.append(a)}for(let e=0;e<100;e++){const e=p.getBoundingClientRect().height,t=p.getBoundingClientRect().width,n=Math.floor(Math.random()*e),d=Math.floor(Math.random()*t),a=document.createElement("div");a.classList.add("star"),a.style.top=`${n}px`,a.style.left=`${d}px`,m.append(a)}let I;fetch("/get-session",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((t=>{const a=t.session;I=a,e.innerText+=`${I.grade}-${I.group} ${I.nickName}님 반가워요!`,d.src=`/texture/profile/${I.profileImage}.png`,fetch("/get-same-class-user-data",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{e.data.forEach((e=>{if(e.uid!==I.uid){const t=document.createElement("div"),d=document.createElement("img"),a=document.createElement("div");t.classList.add("same-class-user"),d.classList.add("same-class-user-image"),d.src=`/texture/profile/${e.profileImage}.png`,a.innerText=e.nickName,e.isTeacher&&(t.style.backgroundColor="#4F59D6"),t.append(d),t.append(a),n.append(t)}}))}))})),t.addEventListener("click",(()=>{fetch("/sign-out",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{"succeed"===e.msg&&location.reload()}))})),a.addEventListener("click",(()=>{i.classList.remove("hidden-right")})),c.addEventListener("click",(()=>{i.classList.add("hidden-right")})),o.addEventListener("focusin",(()=>{r.classList.remove("hidden")})),o.addEventListener("focusout",(()=>{""===o.value&&r.classList.add("hidden")})),o.addEventListener("input",(()=>{const e={search:o.value};fetch("/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{l.replaceChildren(),E.replaceChildren();const t=e.data;t&&t.forEach((e=>{const t=document.createElement("div"),n=document.createElement("div"),d=document.createElement("img"),a=document.createElement("div"),s=document.createElement("div");t.classList.add("search-user-container"),d.classList.add("search-user-image"),a.classList.add("write-rolling-paper"),s.classList.add("write-btn"),d.src=`/texture/profile/${e.profileImage}.png`,n.innerText=`${e.nickName}`,s.innerText="롤링페이퍼 써주기!",a.addEventListener("click",(()=>{g.innerText=`${e.nickName}님의 `,p.classList.remove("hidden-right")})),s.addEventListener("click",(()=>{y.classList.remove("hidden-left")}));let i=!1;JSON.parse(I.writtenUser).forEach((t=>{e.uid===t&&(i=!0)})),a.innerHTML=i?'<span class="material-symbols-outlined">edit</span>':'<span class="material-symbols-outlined">add</span>',t.append(d),t.append(n),t.append(a),l.append(t),E.append(s)}))}))})),u.addEventListener("click",(()=>{p.classList.add("hidden-right")})),h.addEventListener("click",(()=>{y.classList.add("hidden-left")})),B.addEventListener("click",(()=>{const e={paperTitle:f.value,paperDescription:v.value,paperWriterName:L.value};fetch("post-paper",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}))})();